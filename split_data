import os
import random
import shutil

# Path to your main dataset folder (with nested folders)
input_folder = r"C:\Users\ASUS\dataset"

# Path where you want to save 1k sampled images (with same subfolder structure)
output_folder = r"C:\Users\ASUS\sampled_dataset"

# Number of images to extract in total
num_samples = 1000

# Collect all image paths from nested folders
all_images = []
for root, _, files in os.walk(input_folder):
    for file in files:
        if file.lower().endswith(('.png', '.jpg', '.jpeg', '.bmp', '.tiff')):
            all_images.append(os.path.join(root, file))

print(f"Total images found: {len(all_images)}")

# Randomly select 1000 images
sampled_images = random.sample(all_images, num_samples)

# Copy while preserving folder structure
for img_path in sampled_images:
    # Get relative path (subfolder structure)
    rel_path = os.path.relpath(img_path, input_folder)
    dest_path = os.path.join(output_folder, rel_path)

    # Make sure destination folder exists
    os.makedirs(os.path.dirname(dest_path), exist_ok=True)

    # Copy file
    shutil.copy(img_path, dest_path)

print(f"âœ… Extracted {num_samples} images into: {output_folder} (with labels preserved)")
